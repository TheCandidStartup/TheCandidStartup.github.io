<div class="candid-image-div">

{% capture candid_modal_val %}{% increment candid_modal_counter %}{% endcapture %}
{% capture candid_modal_id %}{{ "candid-modal-" | append: candid_modal_val }}{% endcapture %}
{% capture candid_modal_content_id %}{{ "candid-modal-content-" | append: candid_modal_val }}{% endcapture %}
{% capture candid_image_id %}{{ "candid-image-" | append: candid_modal_val }}{% endcapture %}

<img src="{{ include.src }}" alt="{{ include.alt }}" class="candid-image" id="{{ candid_image_id }}">

{% if include.attrib %}
<br/>
<div class="candid-modal-attribution">{{ include.attrib | markdownify }}</div>
{% endif %}

<div class="candid-modal" id="{{ candid_modal_id }}">
   <span class="candid-modal-close" onclick="document.getElementById('{{ candid_modal_id }}').style.display='none'">&times;</span>
   <div class="candid-modal-container">
      <img src="{{ include.src }}" class="candid-modal-content" id="{{ candid_modal_content_id }}">
   </div>
   <div class="candid-modal-caption">{{ include.alt }}</div>
   
   {% if include.attrib %}
   <br/>
   <div class="candid-modal-content-attribution">{{ include.attrib | markdownify }}</div>
   {% endif %}
</div>

<script>
   {
      let img = document.getElementById("{{ candid_image_id }}");
      img.onclick = function(){
         document.getElementById('{{ candid_modal_id }}').style.display='block';
         let modal_img = document.getElementById("{{ candid_modal_content_id }}");
         modal_img.style.minWidth = img.naturalWidth + "px";
      }
   }
</script>

</div>