---
layout: default
---

{% capture temptags %}
  {% for tag in site.tags %}
    {{ tag[1].size | plus: 10000 }}#{{ tag[0] }}#{{ tag[1].size }}
  {% endfor %}
{% endcapture %}
{% assign sortedtemptags = temptags | split:' ' | sort | reverse %}

{% capture sortedtemptagnames %}
{% for temptag in sortedtemptags %}
  {% assign tagitems = temptag | split: '#' %}
  {{ tagitems[1] }}
{% endfor %}
{% endcapture %}
{% assign sortedtagnames = sortedtemptagnames | split:' ' %}

<div>

  {{ content }}

  <h2>Latest Posts</h2>

  <ul class="post-list">
    {% for post in site.posts limit:3 %}
      <li>

        {% assign date_format = site.cayman-blog.date_format | default: "%b %-d, %Y" %}
        <span class="candid-post-meta">{{ post.date | date: date_format }}</span>
      
        {% for tag in post.tags %}
        {% assign sortedtagnames = sortedtagnames | where_exp:"item", "item != tag" %}
        {% assign topic-page = site.topics | where: "topic", tag | first %}
        {% if topic-page %}
          <a class="candid-topic-tag" href="{{ topic-page.url | absolute_url }}" title="{{ topic-page.title }}">{{ topic-page.title | escape }}</a>
        {% endif %}
        {% endfor %}

        <h2>
          <a class="post-link" href="{{ post.url | absolute_url }}" title="{{ post.title }}">{{ post.title | escape }}</a>
        </h2>

        {{ post.excerpt | markdownify | truncatewords: 30 }}
        
        {% assign last-post = post %}
      </li>
    {% endfor %}

    {% assign blog_page = site.pages | where: "ref", "blog" | first %}
      <li>
        {% assign first-post = site.posts | last %}
        <span class="candid-post-meta">{{ first-post.date | date: date_format }} - {{last-post.previous.date | date: date_format }}</span>

        {% for tag in sortedtagnames limit: 5%}
        {% assign topic-page = site.topics | where: "topic", tag | first %}
        {% if topic-page %}
          <a class="candid-topic-tag" href="{{ topic-page.url | absolute_url }}" title="{{ topic-page.title }}">{{ topic-page.title | escape }}</a>
        {% endif %}
        {% endfor %}
        {% capture topic-index-url %}{% link topic-index.html %}{% endcapture %}
        <a class="candid-topic-tag" href="{{ topic-index-url }}" title="...">...</a>

        <h2>
          <a class="post-link" href="{{ blog_page.url | absolute_url }}">More Posts</a>
        </h2>

        <p>There's another {{ site.posts | size | minus: 3 }} posts covering {{ sortedtagnames | size }} more <a href="{{ topic-index-url }}">topics</a>.</p>
      </li>
  </ul>

<h2>Hot Topics</h2>

<div class="candid-topic-cloud">
{% for temptag in sortedtemptags %}
  {% assign tagitems = temptag | split: '#' %}
  {% capture tagname %}{{ tagitems[1] }}{% endcapture %}
  {% capture tagcount %}{{ tagitems[0] | minus: 10000 }}{% endcapture %}
  {% assign topic-page = site.topics | where: "topic", tagname | first %}
  {% if topic-page %}
    {% capture topic-title %}{{ topic-page.title }} ({{ tagcount }}){% endcapture %}
    <a class="candid-topic-tag" href="{{ topic-page.url | absolute_url }}" title="{{ topic-title }} ({{ tagcount }})">{{ topic-title | escape }}</a>
  {% endif %}
{% endfor %}
</div>

</div>
