var we=Object.defineProperty;var ge=(t,e,o)=>e in t?we(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var ue=(t,e,o)=>ge(t,typeof e!="symbol"?e+"":e,o);import{r as I,R as v,j as a,a as Ce}from"./vendor-DnZynArw.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}})();function Oe(t){let e=0;for(let o=0;o<t.length;o++)e=t.charCodeAt(o)-64+e*26;return e-1}function ee(t){let e="";for(t++;t>0;){t--;const o=t%26;t=Math.floor(t/26),e=String.fromCharCode(65+o)+e}return e}function pe(t){const e=/^([A-Z]*)(\d*)$/,o=t.match(e);if(!o)return[void 0,void 0];const s=o[1],r=parseInt(o[2]);return[r>0?r-1:void 0,s||void 0]}function xe(t){const[e,o]=pe(t);return[e,o?Oe(o):void 0]}function Re(t,e){return t!==void 0?e!==void 0?ee(e)+(t+1):(t+1).toString():e!==void 0?ee(e):""}function te(t,e,o,s){if(t==0)return[0,0,[]];let[r,n]=e.offsetToItem(s);r=Math.max(0,Math.min(t-1,r));const l=s+o,w=1,u=1;for(let c=0;c<w&&r>0;c++)r--,n-=e.itemSize(r);const C=r;let g=n;const O=[];for(;g<l&&r<t;){const c=e.itemSize(r);O.push(c),g+=c,r++}for(let c=0;c<u&&r<t;c++){const f=e.itemSize(r);O.push(f),r++}return[C,n,O]}const ve=6e6,Te=100;function re(t,e=ve,o=Te){let s=0,r=0,n=0;t<e?(s=r=t,n=1):(s=e,r=s/o,n=Math.floor(t/r));function l(c){return c<=0?0:c>=n-1?t-s:Math.round((c-1)*(t-s)/(n-3))}const w={scrollOffset:0,renderOffset:0,page:0,scrollDirection:"forward"},[u,C]=I.useState(w);function g(c,f,i){if(u.scrollOffset==i)return[i,u];let d=Math.max(0,Math.min(i,f-c));const m=u.scrollOffset<=d?"forward":"backward";let S,h,z=i;if(Math.abs(d-u.scrollOffset)<c)S=Math.min(n-1,Math.floor((i+u.renderOffset)/r)),h=l(S),S!=u.page&&(d=i+u.renderOffset-h,z=d);else{if(d<r)S=0;else if(d>=s-r)S=n-1;else{const H=(t-r*2)/(s-r*2);S=Math.min(n-3,Math.floor((d-r)*H/r))+1}h=l(S)}const V={scrollOffset:d,renderOffset:h,page:S,scrollDirection:m};return C(V),[z,V]}function O(c,f){const i=Math.min(t-f,Math.max(c,0)),d=u.scrollOffset+u.renderOffset<=i?"forward":"backward",m=Math.min(n-1,Math.floor(i/r)),S=l(m),h=i-S;return C({scrollOffset:h,renderOffset:S,page:m,scrollDirection:d}),h}return{...u,renderSize:s,onScroll:g,doScrollTo:O}}function F(t){return t.addEventListener!==void 0}function ae(t,e,o=window,s={}){const r=I.useRef(),{capture:n,passive:l,once:w}=s;I.useEffect(()=>{r.current=e},[e]),I.useEffect(()=>{if(!o)return;const u=F(o)?o:o.current;if(!u)return;const C=O=>{var c;return(c=r.current)==null?void 0:c.call(r,O)},g={capture:n,passive:l,once:w};return u.addEventListener(t,C,g),()=>{u.removeEventListener(t,C,g)}},[t,o,n,l,w])}if(import.meta.vitest){const{it:t,expect:e}=import.meta.vitest;t("isListener",()=>{e(F(window)).toBe(!0),e(F(document)).toBe(!0),e(F(document.createElement("div"))).toBe(!0),e(F(I.createRef())).toBe(!1)})}function Ie(t,e,o){const s=I.useRef(),r=I.useRef(t);I.useEffect(()=>{r.current=t},[t]);const n=performance.now();I.useEffect(()=>{function l(){s.current=void 0,e!==null&&(performance.now()-n>=e?r.current():s.current=requestAnimationFrame(l))}return l(),()=>{typeof s.current=="number"&&(cancelAnimationFrame(s.current),s.current=void 0)}},[n,e,o])}const _e=150,Ne=500;function he(t=window){const[e,o]=I.useState(0),s="onscrollend"in window,r=s?Ne:_e;return ae("scroll",()=>o(n=>n+1),t),ae("scrollend",()=>o(0),s?t:null),Ie(()=>o(0),e==0?null:r,e),e>0}const ye=(t,e,o)=>`${t}:${e}`,Me=v.forwardRef(function(e,o){const{width:s,height:r,rowCount:n,rowOffsetMapping:l,columnCount:w,columnOffsetMapping:u,children:C,className:g,innerClassName:O,itemData:c=void 0,itemKey:f=ye,onScroll:i,useIsScrolling:d=!1}=e,m=l.itemOffset(n),S=u.itemOffset(w),h=v.useRef(null),{scrollOffset:z,renderOffset:E,renderSize:V,onScroll:H,doScrollTo:p}=re(m,e.maxCssSize,e.minNumPages),{scrollOffset:U,renderOffset:G,renderSize:b,onScroll:q,doScrollTo:K}=re(S,e.maxCssSize,e.minNumPages),Z=he(h);v.useImperativeHandle(o,()=>({scrollTo(N,y){const T=h.current;if(T){const M={};N!=null&&(M.top=p(N,T.clientHeight)),y!=null&&(M.left=K(y,T.clientWidth)),T.scrollTo(M)}},scrollToItem(N,y){const T=N!=null?l.itemOffset(N):void 0,M=y!=null?u.itemOffset(y):void 0;this.scrollTo(T,M)}}),[l,u,p,K]);function X(N){const{clientWidth:y,clientHeight:T,scrollWidth:M,scrollHeight:Se,scrollLeft:ie,scrollTop:le}=N.currentTarget,[ce,Y]=H(T,Se,le),[fe,k]=q(y,M,ie);h.current&&(ce!=le||fe!=ie)&&h.current.scrollTo(fe,ce),i==null||i(Y.scrollOffset+Y.renderOffset,k.scrollOffset+k.renderOffset,Y,k)}const[W,A,D]=te(n,l,r,z+E),[x,R,B]=te(w,u,s,U+G),L=C,P=e.outerComponent||"div",j=e.innerComponent||"div";let _=A-E,$=0,ne=0,J=0,Q=0,se=0;return a.jsx(P,{className:g,onScroll:X,ref:h,style:{position:"relative",height:r,width:s,overflow:"auto",willChange:"transform"},children:a.jsx(j,{className:O,style:{height:V,width:b},children:D.map((N,y)=>(ne=_,_+=N,$=W+y,J=R-G,a.jsx(I.Fragment,{children:B.map((T,M)=>(se=J,J+=T,Q=x+M,a.jsx(L,{data:c,rowIndex:$,columnIndex:Q,isScrolling:d?Z:void 0,style:{position:"absolute",top:ne,height:N,left:se,width:T}},f($,Q,c))))},f($,0,c))))})})}),Ve=(t,e)=>t,de=v.forwardRef(function(e,o){const{width:s,height:r,itemCount:n,itemOffsetMapping:l,children:w,className:u,innerClassName:C,itemData:g=void 0,itemKey:O=Ve,layout:c="vertical",onScroll:f,useIsScrolling:i=!1}=e,d=l.itemOffset(n),m=v.useRef(null),{scrollOffset:S,renderOffset:h,renderSize:z,onScroll:E,doScrollTo:V}=re(d,e.maxCssSize,e.minNumPages),H=he(m),p=c==="vertical";v.useImperativeHandle(o,()=>({scrollTo(x){const R=m.current;R&&(p?R.scrollTo(0,V(x,R.clientHeight)):R.scrollTo(V(x,R.clientWidth),0))},scrollToItem(x){this.scrollTo(l.itemOffset(x))}}),[l,p,V]);function U(x){if(p){const{clientHeight:R,scrollHeight:B,scrollTop:L,scrollLeft:P}=x.currentTarget,[j,_]=E(R,B,L);j!=L&&m.current&&m.current.scrollTo(P,j),f==null||f(_.scrollOffset+_.renderOffset,_)}else{const{clientWidth:R,scrollWidth:B,scrollTop:L,scrollLeft:P}=x.currentTarget,[j,_]=E(R,B,P);j!=P&&m.current&&m.current.scrollTo(j,L),f==null||f(_.scrollOffset+_.renderOffset,_)}}const[G,b,q]=te(n,l,p?r:s,S+h),K=w,Z=e.outerComponent||"div",X=e.innerComponent||"div";let W=b-h,A,D;return a.jsx(Z,{className:u,onScroll:U,ref:m,style:{position:"relative",height:r,width:s,overflow:"auto",willChange:"transform"},children:a.jsx(X,{className:C,style:{height:p?z:"100%",width:p?"100%":z},children:q.map((x,R)=>(D=W,W+=x,A=G+R,a.jsx(K,{data:g,index:A,isScrolling:i?H:void 0,style:{position:"absolute",top:p?D:void 0,left:p?void 0:D,height:p?x:"100%",width:p?"100%":x}},O(A,g))))})})});class ze{constructor(e){ue(this,"fixedItemSize");this.fixedItemSize=e}itemSize(e){return this.fixedItemSize}itemOffset(e){return e*this.fixedItemSize}offsetToItem(e){const o=Math.floor(e/this.fixedItemSize),s=o*this.fixedItemSize;return[o,s]}}function me(t){return new ze(t)}const oe=v.forwardRef(({style:t,...e},o)=>a.jsx("div",{ref:o,style:{...t,overflow:"hidden"},...e}));oe.displayName="HideScrollBar";function je(t,e){return t&&e?t+" "+e:t||e}function Ee(t){const{theme:e}=t,o=me(100),s=me(30),r=v.useRef(null),n=v.useRef(null),l=v.useRef(null),[w,u]=v.useState("");function C(f,i){var d,m;(d=r.current)==null||d.scrollTo(i),(m=n.current)==null||m.scrollTo(f)}const g=({index:f,style:i})=>a.jsx("div",{className:e==null?void 0:e.VirtualSpreadsheet_Column,style:i,children:ee(f)}),O=({index:f,style:i})=>a.jsx("div",{className:e==null?void 0:e.VirtualSpreadsheet_Row,style:i,children:f+1}),c=({rowIndex:f,columnIndex:i,style:d})=>a.jsx("div",{className:e==null?void 0:e.VirtualSpreadsheet_Cell,style:d,children:Re(f,i)});return a.jsxs("div",{className:je(t.className,e==null?void 0:e.VirtualSpreadsheet),style:{display:"grid",gridTemplateColumns:"100px 1fr",gridTemplateRows:"50px 50px 1fr"},children:[a.jsx("div",{className:e==null?void 0:e.VirtualSpreadsheet_Name,style:{gridColumnStart:1,gridColumnEnd:3},children:a.jsxs("label",{children:["Scroll To Row, Column or Cell:",a.jsx("input",{type:"text",value:w,height:200,onChange:f=>{var i;u((i=f.target)==null?void 0:i.value)},onKeyUp:f=>{var i;if(f.key==="Enter"){const[d,m]=xe(w);(i=l.current)==null||i.scrollToItem(d,m)}}})]})}),a.jsx("div",{}),a.jsx(de,{ref:r,className:e==null?void 0:e.VirtualSpreadsheet_ColumnHeader,outerComponent:oe,height:50,itemCount:t.minColumnCount,itemOffsetMapping:o,layout:"horizontal",maxCssSize:t.maxCssSize,minNumPages:t.minNumPages,width:t.width,children:g}),a.jsx(de,{ref:n,className:e==null?void 0:e.VirtualSpreadsheet_RowHeader,outerComponent:oe,height:t.height,itemCount:t.minRowCount,itemOffsetMapping:s,maxCssSize:t.maxCssSize,minNumPages:t.minNumPages,width:100,children:O}),a.jsx(Me,{className:e==null?void 0:e.VirtualSpreadsheet_Grid,ref:l,onScroll:C,height:t.height,rowCount:t.minRowCount,rowOffsetMapping:s,columnCount:t.minColumnCount,columnOffsetMapping:o,maxCssSize:t.maxCssSize,minNumPages:t.minNumPages,width:t.width,children:c})]})}const Le="_VirtualSpreadsheet_ColumnHeader_1sf9h_1",Pe="_VirtualSpreadsheet_RowHeader_1sf9h_1",He="_VirtualSpreadsheet_Grid_1sf9h_1",Ae={VirtualSpreadsheet_ColumnHeader:Le,VirtualSpreadsheet_RowHeader:Pe,VirtualSpreadsheet_Grid:He};function De(){return a.jsx(Ee,{theme:Ae,height:240,minRowCount:100,minColumnCount:26,width:600})}Ce.render(a.jsx(v.StrictMode,{children:a.jsx(De,{})}),document.getElementById("root"));
//# sourceMappingURL=main-aMNxQJeB.js.map
