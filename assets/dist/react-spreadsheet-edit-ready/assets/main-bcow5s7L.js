var $e=Object.defineProperty;var Ue=(r,e,n)=>e in r?$e(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n;var te=(r,e,n)=>Ue(r,typeof e!="symbol"?e+"":e,n);import{R as v,j as d,r as W,f as qe,p as Xe,d as Ye,c as Ze}from"./vendor-DIvOJctV.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function t(s){if(s.ep)return;s.ep=!0;const l=n(s);fetch(s.href,l)}})();const Qe=({...r},e)=>d.jsx("div",{ref:e,...r}),re=v.forwardRef(function({render:e=Qe,...n},t){return e(n,t)});function me(r){const{children:e,className:n,style:t}=r,[s,l]=v.useState(0),[a,S]=v.useState(0),T=v.useRef(null),g=v.useCallback(R=>{R.forEach(h=>{const j=Math.round(h.contentBoxSize[0].inlineSize);l(j);const M=Math.round(h.borderBoxSize[0].blockSize);S(M)})},[]);v.useLayoutEffect(()=>{const R=T.current;if(R&&(S(R.clientHeight),l(R.clientWidth),typeof ResizeObserver<"u")){const h=new ResizeObserver(g);return h.observe(R),()=>{h.disconnect()}}},[g]);const y=a>0&&s>0;return d.jsx("div",{ref:T,className:n,style:t,children:d.jsx("div",{style:{overflow:"visible",width:0,height:0},children:y&&e({height:a,width:s})})})}const Je=6e6,et=100;function ze(r,e=Je,n=et,t=!0){let s=0,l=0,a=0;r<e?(s=l=r,a=1):(s=e,l=s/n,a=Math.floor(r/l));function S(c){return c<=0?0:c>=a-1?r-s:Math.round((c-1)*(r-s)/(a-3))}const T={scrollOffset:0,renderOffset:0,page:0,scrollDirection:"forward"},[g,y]=W.useState(0),R=W.useRef(T);function h(c,C,m){const f=R.current;if(f.scrollOffset==m)return[m,f];let _=Math.max(0,Math.min(m,C-c));const p=f.scrollOffset<=_?"forward":"backward";let w,x,B=m;if(Math.abs(_-f.scrollOffset)<c)w=Math.min(a-1,Math.floor((m+f.renderOffset)/l)),x=S(w),w!=f.page&&(_=m+f.renderOffset-x,B=_);else{if(_<l)w=0;else if(_>=s-l)w=a-1;else{const X=(r-l*2)/(s-l*2);w=Math.min(a-3,Math.floor((_-l)*X/l))+1}x=S(w)}const V={scrollOffset:_,renderOffset:x,page:w,scrollDirection:p};return R.current=V,t&&y(_+x),[B,V]}function j(c,C){const m=R.current,f=Math.min(r-C,Math.max(c,0)),_=m.scrollOffset+m.renderOffset<=f?"forward":"backward",p=Math.min(a-1,Math.floor(f/l)),w=S(p),x=f-w;return R.current={scrollOffset:x,renderOffset:w,page:p,scrollDirection:_},t&&y(x+w),x}function M(){const c=R.current;return c.scrollOffset+c.renderOffset}return{totalOffset:g,renderSize:s,onScroll:h,doScrollTo:j,getCurrentOffset:M,scrollState:R}}function oe(r){return r.addEventListener!==void 0}function be(r,e,n=window,t={}){const s=W.useRef(),{capture:l,passive:a,once:S}=t;W.useEffect(()=>{s.current=e},[e]),W.useEffect(()=>{if(!n)return;const T=oe(n)?n:n.current;if(!T)return;const g=R=>{var h;return(h=s.current)==null?void 0:h.call(s,R)},y={capture:l,passive:a,once:S};return T.addEventListener(r,g,y),()=>{T.removeEventListener(r,g,y)}},[r,n,l,a,S])}if(import.meta.vitest){const{it:r,expect:e}=import.meta.vitest;r("isListener",()=>{e(oe(window)).toBe(!0),e(oe(document)).toBe(!0),e(oe(document.createElement("div"))).toBe(!0),e(oe(W.createRef())).toBe(!1)})}function tt(r,e,n){const t=W.useRef(),s=W.useRef(r);W.useEffect(()=>{s.current=r},[r]);const l=performance.now();W.useEffect(()=>{function a(){t.current=void 0,e!==null&&(performance.now()-l>=e?s.current():t.current=requestAnimationFrame(a))}return a(),()=>{typeof t.current=="number"&&(cancelAnimationFrame(t.current),t.current=void 0)}},[l,e,n])}const rt=150,nt=500;function st(r=window){const[e,n]=W.useState(0),t="onscrollend"in window,s=t?nt:rt;return be("scroll",()=>n(l=>l+1),r),be("scrollend",()=>n(0),t?r:null),tt(()=>n(0),e==0?null:s,e),e>0}function ce(r,e,n,t,s){if(r===void 0)return;if(s!="visible"||r<t)return r;e=e||0;const l=r+e,a=t+n;if(!(l<=a))return e>n?r:r-n+e}const _e=v.forwardRef(function(e,n){const{width:t,height:s,scrollWidth:l=0,scrollHeight:a=0,className:S,innerClassName:T,children:g,onScroll:y,useIsScrolling:R=!1,useOffsets:h=!0,innerRender:j,outerRender:M}=e,c=v.useRef(null),{totalOffset:C,renderSize:m,onScroll:f,doScrollTo:_,getCurrentOffset:p}=ze(a,e.maxCssSize,e.minNumPages,h),{totalOffset:w,renderSize:x,onScroll:B,doScrollTo:E,getCurrentOffset:V}=ze(l,e.maxCssSize,e.minNumPages,h),X=st(c);v.useImperativeHandle(n,()=>({scrollTo(F,k){if(F===void 0&&k===void 0)return;const N=c.current;if(N){const H={};F!=null&&(H.top=_(F,N.clientHeight)),k!=null&&(H.left=E(k,N.clientWidth)),N.scrollTo(H)}},scrollToArea(F,k,N,H,Z){const G=c.current;if(!G)return;const K=ce(F,k,G.clientHeight,C,Z),L=ce(N,H,G.clientWidth,w,Z);this.scrollTo(K,L)},get clientWidth(){return c.current?c.current.clientWidth:0},get clientHeight(){return c.current?c.current.clientHeight:0},get verticalOffset(){return p()},get horizontalOffset(){return V()}}),[_,E,C,w,p,V]);function z(F){const{clientWidth:k,clientHeight:N,scrollWidth:H,scrollHeight:Z,scrollLeft:G,scrollTop:K}=F.currentTarget,[L,ee]=f(N,Z,K),[ie,$]=B(k,H,G);c.current&&(L!=K||ie!=G)&&c.current.scrollTo(ie,L),y==null||y(ee.scrollOffset+ee.renderOffset,$.scrollOffset+$.renderOffset,ee,$)}const Y=R?X:void 0,D=C,A=w;return d.jsxs(re,{className:S,render:M,onScroll:z,ref:c,style:{position:"relative",height:s,width:t,overflow:"auto",willChange:"transform"},children:[d.jsx(re,{className:T,render:j,style:{zIndex:1,position:"sticky",top:0,left:0,width:"100%",height:"100%"},children:g({isScrolling:Y,verticalOffset:D,horizontalOffset:A})}),d.jsx("div",{style:{position:"absolute",top:0,left:0,height:a?m:"100%",width:l?x:"100%"}})]})});function de(r,e,n,t){if(r==0)return[0,0,0,[]];if(t<0&&(n+=t,t=0),n<=0)return[0,0,0,[]];const[s,l]=e.offsetToItem(t);if(s>=r)return[0,0,0,[]];let a=Math.max(0,Math.min(r-1,s));const S=t+n,T=a;let g=l;const y=[];let R=0;for(;g<S&&a<r;){const h=e.itemSize(a);y.push(h),R+=h,g+=h,a++}return[T,l,R,y]}function Ie(r,e){return r==1?`${e}px`:`repeat(${r},${e}px)`}function Me(r,e){return r?r+" "+e:e}function he(r){const e=r.length;if(e==0)return;let n,t=r[0],s=1;for(let a=1;a<e;a++){const S=r[a];if(S==t)s++;else{const T=Ie(s,t);n=Me(n,T),t=S,s=1}}const l=Ie(s,t);return Me(n,l)}const ot=(r,e)=>r,it={boxSizing:"border-box"};function pe(r){const{width:e,height:n,itemCount:t,itemOffsetMapping:s,className:l,innerClassName:a,offset:S,children:T,itemData:g,itemKey:y=ot,layout:R="vertical",outerRender:h,innerRender:j,isScrolling:M}=r,c=R==="vertical",[C,m,f,_]=de(t,s,c?n:e,S),p=he(_),w=m-S,x=T;return d.jsx(re,{className:l,render:h,style:{position:"relative",height:n,width:e,overflow:"hidden",willChange:"transform"},children:d.jsx(re,{className:a,render:j,style:{position:"absolute",display:"grid",gridTemplateColumns:c?void 0:p,gridTemplateRows:c?p:void 0,top:c?w:0,left:c?0:w,height:c?f:"100%",width:c?"100%":f},children:_.map((B,E)=>d.jsx(x,{data:g,isScrolling:M,index:C+E,style:it},y(C+E,g)))})})}const lt=(r,e,n)=>`${r}:${e}`,at={boxSizing:"border-box"};function He(r){const{width:e,height:n,rowCount:t,rowOffsetMapping:s,columnCount:l,columnOffsetMapping:a,className:S,innerClassName:T,rowOffset:g,columnOffset:y,children:R,itemData:h,itemKey:j=lt,outerRender:M,innerRender:c,isScrolling:C}=r,[m,f,_,p]=de(t,s,n,g),w=he(p),[x,B,E,V]=de(l,a,e,y),X=he(V),z=f-g,Y=B-y,D=R;return d.jsx(re,{className:S,render:M,style:{position:"relative",height:n,width:e,overflow:"hidden",willChange:"transform"},children:d.jsx(re,{className:T,render:c,style:{position:"absolute",display:"grid",gridTemplateColumns:X,gridTemplateRows:w,top:z,left:Y,height:_,width:E},children:p.map((A,F)=>d.jsx(W.Fragment,{children:V.map((k,N)=>d.jsx(D,{data:h,isScrolling:C,rowIndex:m+F,columnIndex:x+N,style:at},j(m+F,x+N,h)))},j(m+F,0,h)))})})}function ue(r,e){return r===void 0?[void 0,void 0]:[e.itemOffset(r),e.itemSize(r)]}function ct(r,e,n,t,s,l){const a=r.current;if(!a)return;const[S,T]=ue(t,e),[g,y]=ue(s,n);a.scrollToArea(S,T,g,y,l)}v.forwardRef(function(e,n){const{rowCount:t,rowOffsetMapping:s,columnCount:l,columnOffsetMapping:a,children:S,innerClassName:T,innerRender:g,itemData:y,itemKey:R,onScroll:h,...j}=e,M=s.itemOffset(t),c=a.itemOffset(l),C=v.useRef(null);v.useImperativeHandle(n,()=>({scrollTo(f,_){const p=C.current;p&&p.scrollTo(f,_)},scrollToItem(f,_,p){ct(C,s,a,f,_,p)},get clientWidth(){return C.current?C.current.clientWidth:0},get clientHeight(){return C.current?C.current.clientHeight:0},get verticalOffset(){return C.current?C.current.verticalOffset:0},get horizontalOffset(){return C.current?C.current.horizontalOffset:0}}),[s,a]);const m=S;return d.jsx(_e,{ref:C,...j,scrollHeight:M,scrollWidth:c,onScroll:(f,_,p,w)=>{h&&h(f,_,p,w)},children:({isScrolling:f,verticalOffset:_,horizontalOffset:p})=>d.jsx(me,{style:{height:"100%",width:"100%"},children:({height:w,width:x})=>d.jsx(He,{innerClassName:T,innerRender:g,rowOffset:_,columnOffset:p,height:w,rowCount:t,columnCount:l,itemData:y,itemKey:R,isScrolling:f,rowOffsetMapping:s,columnOffsetMapping:a,width:x,children:m})})})});function ut(r,e,n,t,s){const l=r.current;if(!l)return;const a=e.itemOffset(t),S=e.itemSize(t);n?l.scrollToArea(a,S,void 0,void 0,s):l.scrollToArea(void 0,void 0,a,S,s)}v.forwardRef(function(e,n){const{itemCount:t,itemOffsetMapping:s,children:l,layout:a="vertical",onScroll:S,innerClassName:T,innerRender:g,itemData:y,itemKey:R,...h}=e,j=s.itemOffset(t),M=v.useRef(null),c=a==="vertical";v.useImperativeHandle(n,()=>({scrollTo(m){const f=M.current;f&&(c?f.scrollTo(m,void 0):f.scrollTo(void 0,m))},scrollToItem(m,f){ut(M,s,c,m,f)},get offset(){const m=M.current;return m?c?m.verticalOffset:m.horizontalOffset:0}}),[s,c]);const C=l;return d.jsx(_e,{ref:M,...h,scrollHeight:c?j:void 0,scrollWidth:c?void 0:j,onScroll:(m,f,_,p)=>{S&&S(c?m:f,c?_:p)},children:({isScrolling:m,verticalOffset:f,horizontalOffset:_})=>d.jsx(me,{style:{height:"100%",width:"100%"},children:({height:p,width:w})=>d.jsx(pe,{innerClassName:T,innerRender:g,layout:a,offset:c?f:_,height:p,itemCount:t,itemData:y,itemKey:R,isScrolling:m,itemOffsetMapping:s,width:w,children:C})})})});class ft{constructor(e){te(this,"fixedItemSize");this.fixedItemSize=e}itemSize(e){return this.fixedItemSize}itemOffset(e){return e*this.fixedItemSize}offsetToItem(e){const n=Math.floor(e/this.fixedItemSize),t=n*this.fixedItemSize;return[n,t]}}function De(r){return new ft(r)}class dt{constructor(e,n){te(this,"defaultItemSize");te(this,"sizes");this.defaultItemSize=e,this.sizes=n}itemSize(e){return e<this.sizes.length?this.sizes[e]:this.defaultItemSize}itemOffset(e){let n=0,t=this.sizes.length;e>t?n=(e-t)*this.defaultItemSize:t=e;for(let s=0;s<t;s++)n+=this.sizes[s];return n}offsetToItem(e){let n=0;const t=this.sizes.length;for(let l=0;l<t;l++){const a=this.sizes[l];if(n+a>e)return[l,n];n+=a}const s=Math.floor((e-n)/this.defaultItemSize);return n+=s*this.defaultItemSize,[s+t,n]}}function Fe(r,e){return new dt(r,e||[])}const ht=De(30),pt=De(100);class St{subscribe(e){return()=>{}}getSnapshot(){return 0}getRowCount(e){return 0}getRowItemOffsetMapping(e){return ht}getColumnCount(e){return 0}getColumnItemOffsetMapping(e){return pt}getCellValue(e,n,t){return null}getCellFormat(e,n,t){}setCellValueAndFormat(e,n,t,s){return!1}}function mt(r){let e=0;for(let n=0;n<r.length;n++)e=r.charCodeAt(n)-64+e*26;return e-1}function Se(r){let e="";for(r++;r>0;){r--;const n=r%26;r=Math.floor(r/26),e=String.fromCharCode(65+n)+e}return e}function _t(r){const e=/^([A-Z]*)(\d*)$/,n=r.match(e);if(!n)return[void 0,void 0];const t=n[1],s=parseInt(n[2]);return[s>0?s-1:void 0,t||void 0]}function gt(r){const[e,n]=_t(r);return[e,n?mt(n):void 0]}function Ct(r,e){return r!==void 0?e!==void 0?Se(e)+(r+1):(r+1).toString():e!==void 0?Se(e):""}const wt={VirtualSpreadsheet:"VirtualSpreadsheet",VirtualSpreadsheet_InputBar:"VirtualSpreadsheet_InputBar",VirtualSpreadsheet_Name:"VirtualSpreadsheet_Name",VirtualSpreadsheet_Fx:"VirtualSpreadsheet_Fx",VirtualSpreadsheet_Formula:"VirtualSpreadsheet_Formula",VirtualSpreadsheet_Grid:"VirtualSpreadsheet_Grid",VirtualSpreadsheet_CornerHeader:"VirtualSpreadsheet_CornerHeader",VirtualSpreadsheet_ColumnHeader:"VirtualSpreadsheet_ColumnHeader",VirtualSpreadsheet_Column:"VirtualSpreadsheet_Column",VirtualSpreadsheet_Column__Selected:"VirtualSpreadsheet_Column__Selected",VirtualSpreadsheet_Column__CellSelected:"VirtualSpreadsheet_Column__CellSelected",VirtualSpreadsheet_RowHeader:"VirtualSpreadsheet_RowHeader",VirtualSpreadsheet_Row:"VirtualSpreadsheet_Row",VirtualSpreadsheet_Row__Selected:"VirtualSpreadsheet_Row__Selected",VirtualSpreadsheet_Row__CellSelected:"VirtualSpreadsheet_Row__CellSelected",VirtualSpreadsheet_Cell:"VirtualSpreadsheet_Cell",VirtualSpreadsheet_Cell__Type_string:"VirtualSpreadsheet_Cell__Type_string",VirtualSpreadsheet_Cell__Type_number:"VirtualSpreadsheet_Cell__Type_number",VirtualSpreadsheet_Cell__Type_boolean:"VirtualSpreadsheet_Cell__Type_boolean",VirtualSpreadsheet_Cell__Type_null:"VirtualSpreadsheet_Cell__Type_null",VirtualSpreadsheet_Cell__Type_undefined:"VirtualSpreadsheet_Cell__Type_undefined",VirtualSpreadsheet_Cell__Type_CellError:"VirtualSpreadsheet_Cell__Type_CellError",VirtualSpreadsheet_Cell__Focus:"VirtualSpreadsheet_Cell__Focus",VirtualSpreadsheet_Cell__RowSelected:"VirtualSpreadsheet_Cell__RowSelected",VirtualSpreadsheet_Cell__ColumnSelected:"VirtualSpreadsheet_Cell__ColumnSelected"};function se(...r){let e;return r.forEach(n=>{e&&n?e=e+" "+n:n&&(e=n)}),e}function J(r,e){return r?e:void 0}const vt={leap1900:!1,dateSpanLarge:!0};function je(r,e){return r==null?"":typeof r=="object"?r.value:typeof r=="string"&&r[0]=="'"?r.substring(1):(e===void 0&&(e=""),qe(e,r,vt))}function Rt(r){if(r===null)return"VirtualSpreadsheet_Cell__Type_null";if(r===void 0)return"VirtualSpreadsheet_Cell__Type_undefined";const e=typeof r;return e==="object"?"VirtualSpreadsheet_Cell__Type_CellError":"VirtualSpreadsheet_Cell__Type_"+e}function Ne({index:r,data:e,style:n}){return e(r,n)}function Ot({rowIndex:r,columnIndex:e,data:n,style:t}){return n(r,e,t)}function Vt(r){var Ve;const{width:e,height:n,theme:t,data:s,minRowCount:l=100,minColumnCount:a=26,maxRowCount:S=1e12,maxColumnCount:T=1e12}=r,g=v.useRef(null),y=v.useRef(null),R=v.useCallback(o=>s.subscribe(o),[s]),h=v.useSyncExternalStore(R,s.getSnapshot.bind(s),(Ve=s.getServerSnapshot)==null?void 0:Ve.bind(s)),[j,M]=v.useState(""),[c,C]=v.useState(""),[m,f]=v.useState(""),[_,p]=v.useState(!1),[w,x]=v.useState(0),[B,E]=v.useState(0),[V,X]=v.useState([void 0,void 0]),[z,Y]=v.useState(null),[[D,A],F]=v.useState([0,0]),k=s.getRowCount(h),N=Math.max(l,k,w+1,z?z[0]+1:0),H=s.getRowItemOffsetMapping(h),Z=H.itemOffset(N),G=s.getColumnCount(h),K=Math.max(a,G,B+1,z?z[1]+1:0),L=s.getColumnItemOffsetMapping(h),ee=L.itemOffset(K);v.useEffect(()=>{var o;(o=g.current)==null||o.scrollTo(D,A)},[D,A]),v.useEffect(()=>{var o;(o=y.current)==null||o.focus({preventScroll:!0})},[z]);function ie(o,i){o==D&&i==A||(o==0?x(0):g.current&&o+g.current.clientHeight==Z&&w<N&&N<S&&x(N),i==0?E(0):g.current&&i+g.current.clientWidth==ee&&B<K&&K<T&&E(K),F([o,i]))}function $(o,i,u){if(o<k&&i<G){const b=s.getCellValue(h,o,i),O=s.getCellFormat(h,o,i),I=je(b,O);C(I),f(u?I:"")}else C(""),f("")}function ge(o,i){(!z||o!=z[0]||i!=z[1])&&($(o,i,!1),p(!1)),Y([o,i])}function le(o,i){if(o===void 0&&i===void 0){Y(null),C(""),f(""),p(!1);return}(o!==V[0]||i!==V[1])&&(X([o,i]),M(Ct(o,i))),ge(o||0,i||0)}function fe(o,i){const u=g.current;if(!u)return;const b=ue(o,H),O=ue(i,L),I=ce(...b,u.clientHeight,D,"visible"),P=ce(...O,u.clientWidth,A,"visible");(I!==void 0||P!==void 0)&&F([I===void 0?D:I,P===void 0?A:P])}function Ce(o,i){return o===void 0||i===void 0?!1:V[0]===void 0&&i===V[1]||V[1]===void 0&&o===V[0]}function U(o,i,u){if(o!==void 0){if(o<0)return;o>=S&&(o=S-1),o>w?x(o):o==0&&x(0)}if(i!==void 0){if(i<0)return;i>=T&&(i=T-1),i>B?E(i):i==0&&E(0)}u&&Ce(o,i)?ge(o||0,i||0):le(o,i),fe(o,i)}function ae(o,i,u,b){if(V[0]===void 0&&V[1]===void 0)return;const O=b?-1:1;V[0]===void 0?U(o+O,i,!0):V[1]===void 0?U(o,i+O,!0):u?U(o+O,i):U(o,i+O)}function Ee(o){if(o.key!=="Enter")return;const[i,u]=gt(j);U(i,u)}function we(o,i){let u,b;const O=Xe(c);O?(u=O.v,b=O.z):u=c,s.setCellValueAndFormat(o,i,u,b)}function ve(o){if(!z)return;const i=z[0],u=z[1];if(_)switch(o.key){case"Escape":$(i,u,!1),p(!1),Y([i,u]);break;case"Enter":we(i,u),$(i,u,!1),p(!1),ae(i,u,!0,o.shiftKey);break;case"Tab":we(i,u),$(i,u,!1),p(!1),ae(i,u,!1,o.shiftKey),o.preventDefault();break}else switch(o.key){case"ArrowDown":U(i+1,u),o.preventDefault();break;case"ArrowUp":U(i-1,u),o.preventDefault();break;case"ArrowLeft":U(i,u-1),o.preventDefault();break;case"ArrowRight":U(i,u+1),o.preventDefault();break;case"Tab":ae(i,u,!1,o.shiftKey),o.preventDefault();break;case"Enter":Ce(i,u)?ae(i,u,!0,o.shiftKey):($(i,u,!0),p(!0));break}}function Re(o){return V[0]==null&&V[1]==o}function Ae(o){return V[0]!=null&&(V[1]==null||V[1]==o)}function Oe(o){return V[0]==o&&V[1]==null}function Le(o){return V[1]!=null&&(V[0]==null||V[0]==o)}const ke=({...o},i)=>d.jsx("div",{ref:i,onClick:u=>{const b=u.currentTarget.getBoundingClientRect(),O=u.clientX-b.left+A,[I]=L.offsetToItem(O);le(void 0,I)},...o}),We=({...o},i)=>d.jsx("div",{ref:i,onClick:u=>{const b=u.currentTarget.getBoundingClientRect(),O=u.clientY-b.top+D,[I]=H.offsetToItem(O);le(I,void 0)},...o}),Be=(o,i)=>d.jsx("div",{className:se(t==null?void 0:t.VirtualSpreadsheet_Column,J(Re(o),t==null?void 0:t.VirtualSpreadsheet_Column__Selected),J(Ae(o),t==null?void 0:t.VirtualSpreadsheet_Column__CellSelected)),style:i,children:Se(o)}),Ke=(o,i)=>d.jsx("div",{className:se(t==null?void 0:t.VirtualSpreadsheet_Row,J(Oe(o),t==null?void 0:t.VirtualSpreadsheet_Row__Selected),J(Le(o),t==null?void 0:t.VirtualSpreadsheet_Row__CellSelected)),style:i,children:o+1}),Pe=({children:o,...i},u)=>{let b;if(z){const O=z[0],I=z[1],P=H.itemSize(O);let q=H.itemOffset(O)-D;q<-P?q=-P:q>n&&(q=n);const ne=L.itemSize(I);let Q=L.itemOffset(I)-A;Q<-ne?Q=-ne:Q>e&&(Q=e),b=d.jsx("input",{ref:y,className:se(t==null?void 0:t.VirtualSpreadsheet_Cell,t==null?void 0:t.VirtualSpreadsheet_Cell__Focus),type:"text",value:m,onChange:Te=>{var ye,xe;f((ye=Te.target)==null?void 0:ye.value),p(!0),C((xe=Te.target)==null?void 0:xe.value)},onFocus:()=>{fe(O,I)},onBeforeInput:()=>{fe(O,I)},onKeyDown:ve,style:{zIndex:_?1:-1,position:"absolute",top:q,height:P,left:Q,width:ne}})}return d.jsxs("div",{ref:u,onClick:O=>{const I=O.currentTarget.getBoundingClientRect(),P=O.clientX-I.left+A,q=O.clientY-I.top+D,[ne]=H.offsetToItem(q),[Q]=L.offsetToItem(P);le(ne,Q)},onDoubleClick:O=>{f(c),p(!0)},...i,children:[o,b]})},Ge=(o,i,u)=>{let b,O="";if(o<k&&i<G){b=s.getCellValue(h,o,i);const q=s.getCellFormat(h,o,i);O=je(b,q)}const I=z&&o==z[0]&&i==z[1],P=se(t==null?void 0:t.VirtualSpreadsheet_Cell,J(Oe(o),t==null?void 0:t.VirtualSpreadsheet_Cell__RowSelected),J(Re(i),t==null?void 0:t.VirtualSpreadsheet_Cell__ColumnSelected),Rt(b),J(I,t==null?void 0:t.VirtualSpreadsheet_Cell__Focus));return d.jsx("div",{className:P,style:u,children:O})};return d.jsxs("div",{className:se(r.className,t==null?void 0:t.VirtualSpreadsheet),style:{display:"grid",gridTemplateColumns:"100px 1fr",gridTemplateRows:"30px 50px 1fr"},children:[d.jsxs("div",{className:t==null?void 0:t.VirtualSpreadsheet_InputBar,style:{display:"flex",gridColumnStart:1,gridColumnEnd:3},children:[d.jsx("input",{className:t==null?void 0:t.VirtualSpreadsheet_Name,type:"text",name:"name",title:"Name",value:j,size:20,onChange:o=>{var i;M((i=o.target)==null?void 0:i.value)},onKeyUp:Ee}),d.jsx("label",{className:t==null?void 0:t.VirtualSpreadsheet_Fx,children:"fx"}),d.jsx("input",{className:t==null?void 0:t.VirtualSpreadsheet_Formula,style:{flexGrow:1},type:"text",name:"formula",title:"Formula",value:c,onChange:o=>{var i,u;C((i=o.target)==null?void 0:i.value),p(!0),z&&f((u=o.target)==null?void 0:u.value)},onFocus:()=>{z&&(f(c),p(!0))},onKeyDown:ve})]}),d.jsx("div",{className:t==null?void 0:t.VirtualSpreadsheet_CornerHeader}),d.jsx(pe,{offset:A,className:t==null?void 0:t.VirtualSpreadsheet_ColumnHeader,itemData:Be,outerRender:ke,height:50,itemCount:K,itemOffsetMapping:L,layout:"horizontal",width:r.width,children:Ne}),d.jsx(pe,{offset:D,className:t==null?void 0:t.VirtualSpreadsheet_RowHeader,itemData:Ke,outerRender:We,height:r.height,itemCount:N,itemOffsetMapping:H,width:100,children:Ne}),d.jsx(_e,{className:t==null?void 0:t.VirtualSpreadsheet_Grid,ref:g,onScroll:ie,height:r.height,width:r.width,scrollHeight:Z,scrollWidth:ee,useOffsets:!1,maxCssSize:r.maxCssSize,minNumPages:r.minNumPages,children:o=>d.jsx(me,{style:{height:"100%",width:"100%"},children:({height:i,width:u})=>d.jsx(He,{rowOffset:D,columnOffset:A,height:i,width:u,itemData:Ge,outerRender:Pe,rowCount:N,rowOffsetMapping:H,columnCount:K,columnOffsetMapping:L,children:Ot})})})]})}const Tt=["Date","Time","Item","Price","Quantity","Cost","Tax Rate","Tax","Subtotal","Transaction Fee","Total","Running Total"],yt=["First","Last","Count","Average","Max","Total","Min","Total","Total","Total","Total","Running Total"],xt=Fe(100,[160]),zt=Fe(30,[50]);class bt extends St{constructor(){super();te(this,"count");te(this,"base");this.count=1e6;const t=Ye(new Date)||0;this.base=t-this.count/(24*60)}subscribe(n){const t=setInterval(()=>{this.count++,n()},6e4);return()=>{clearInterval(t)}}getSnapshot(){return this.count}getRowCount(n){return n+4}getRowItemOffsetMapping(n){return zt}getColumnCount(n){return 12}getColumnItemOffsetMapping(n){return xt}dateTime(n){return this.base+n/(24*60)}totalRow(n,t){switch(t){case 0:return this.dateTime(1);case 1:return this.dateTime(n);case 2:return n;case 3:return .01;case 4:return 80;case 5:return .8*n;case 6:return .15;case 7:return .12*n;case 8:return .92*n;case 9:return .08*n;case 10:return n;case 11:return n}}getCellValue(n,t,s){if(t==0)return Tt[s];if(t==n+1)return;if(t==n+2)return yt[s];if(t==n+3)return this.totalRow(n,s);const l=this.dateTime(t);switch(s){case 0:return l;case 1:return l;case 2:return"Nails";case 3:return .01;case 4:return 80;case 5:return .8;case 6:return .15;case 7:return .12;case 8:return .92;case 9:return .08;case 10:return 1;case 11:return t}}getCellFormat(n,t,s){if(t==n+3&&s==1)return"yyyy-mm-dd";switch(s){case 0:return"yyyy-mm-dd";case 1:return"hh:mm";case 6:return"0%";case 3:case 5:case 7:case 8:case 9:case 10:case 11:return"$0.00";default:return}}}const It=new bt;function Mt(){return d.jsx(Vt,{data:It,theme:wt,height:300,width:600})}Ze(document.getElementById("root")).render(d.jsx(v.StrictMode,{children:d.jsx(Mt,{})}));
//# sourceMappingURL=main-bcow5s7L.js.map
