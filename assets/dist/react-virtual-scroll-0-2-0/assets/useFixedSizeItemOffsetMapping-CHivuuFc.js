var le=Object.defineProperty;var ie=(t,e,r)=>e in t?le(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var te=(t,e,r)=>(ie(t,typeof e!="symbol"?e+"":e,r),r);import{r as p,R as L,j as E}from"./vendor-Bnznptw5.js";function N(t,e,r,o){if(t==0)return[0,0,[]];var[n,u]=e.offsetToItem(o);n=Math.max(0,Math.min(t-1,n));var s=o+r;const S=1,a=1;for(let l=0;l<S&&n>0;l++)n--,u-=e.itemSize(n);const g=n;var c=u;const d=[];for(;c<s&&n<t;){const l=e.itemSize(n);d.push(l),c+=l,n++}for(let l=0;l<a&&n<t;l++){const i=e.itemSize(n);d.push(i),n++}return[g,u,d]}const re=6e6,ce=100;function U(t){let e=0,r=0,o=0;t<re?(e=r=t,o=1):(e=re,r=e/ce,o=Math.floor(t/r));function n(c){return c<=0?0:c>=o-1?t-e:Math.round((c-1)*(t-e)/(o-3))}const u={scrollOffset:0,renderOffset:0,page:0,scrollDirection:"forward"},[s,S]=p.useState(u);function a(c,d,l){if(s.scrollOffset==l)return l;let i=Math.max(0,Math.min(l,d-c));const v=s.scrollOffset<=i?"forward":"backward";let f,w,I=l;if(Math.abs(i-s.scrollOffset)<c)f=Math.min(o-1,Math.floor((l+s.renderOffset)/r)),w=n(f),f!=s.page&&(i=l+s.renderOffset-w,I=i);else{if(i<r)f=0;else if(i>=e-r)f=o-1;else{const y=(t-r*2)/(e-r*2);f=Math.min(o-3,Math.floor((i-r)*y/r))+1}w=n(f)}return S({scrollOffset:i,renderOffset:w,page:f,scrollDirection:v}),I}function g(c,d){const l=Math.min(t-d,Math.max(c,0)),i=s.scrollOffset+s.renderOffset<=l?"forward":"backward",v=Math.min(o-1,Math.floor(l/r)),f=n(v),w=l-f;return S({scrollOffset:w,renderOffset:f,page:v,scrollDirection:i}),w}return{...s,renderSize:e,onScroll:a,doScrollTo:g}}function A(t){return t.addEventListener!==void 0}function oe(t,e,r=window,o={}){const n=p.useRef(),{capture:u,passive:s,once:S}=o;p.useEffect(()=>{n.current=e},[e]),p.useEffect(()=>{if(!r)return;const a=A(r)?r:r.current;if(!a)return;const g=d=>n.current(d),c={capture:u,passive:s,once:S};return a.addEventListener(t,g,c),()=>{a.removeEventListener(t,g,c)}},[t,r,u,s,S])}if(import.meta.vitest){const{it:t,expect:e}=import.meta.vitest;t("isListener",()=>{e(A(window)).toBe(!0),e(A(document)).toBe(!0),e(A(document.createElement("div"))).toBe(!0),e(A(p.createRef())).toBe(!1)})}function fe(t,e,r){const o=p.useRef(),n=p.useRef(t);p.useEffect(()=>{n.current=t},[t]);const u=performance.now();p.useEffect(()=>{function s(){o.current=void 0,e!==null&&(performance.now()-u>=e?n.current():o.current=requestAnimationFrame(s))}return s(),()=>{typeof o.current=="number"&&(cancelAnimationFrame(o.current),o.current=void 0)}},[e,r])}const ue=150,ae=500;function ne(t=window){const[e,r]=p.useState(0),o="onscrollend"in window,n=o?ae:ue;return oe("scroll",()=>r(u=>u+1),t),oe("scrollend",()=>r(0),o?t:null),fe(()=>r(0),e==0?null:n,e),e>0}const de=(t,e,r)=>`${t}:${e}`,Oe=L.forwardRef(function(e,r){const{width:o,height:n,rowCount:u,rowOffsetMapping:s,columnCount:S,columnOffsetMapping:a,children:g,itemData:c=void 0,itemKey:d=de,useIsScrolling:l=!1}=e,i=s.itemOffset(u),v=a.itemOffset(S),f=L.useRef(null),{scrollOffset:w,renderOffset:I,renderSize:V,onScroll:y,doScrollTo:O}=U(i),{scrollOffset:W,renderOffset:H,renderSize:b,onScroll:K,doScrollTo:P}=U(v),B=ne(f);L.useImperativeHandle(r,()=>({scrollTo(T,M){const x=f.current;x&&x.scrollTo(P(M,x.clientWidth),O(T,x.clientHeight))},scrollToItem(T,M){this.scrollTo(s.itemOffset(T),a.itemOffset(M))}}),[s,a]);function D(T){const{clientWidth:M,clientHeight:x,scrollWidth:G,scrollHeight:se,scrollLeft:J,scrollTop:Q}=T.currentTarget,Y=y(x,se,Q),ee=K(M,G,J);f.current&&(Y!=Q||ee!=J)&&f.current.scrollTo(ee,Y)}const[_,m,h]=N(u,s,n,w+I),[j,C,z]=N(S,a,o,W+H),R=g;let q=m-I,F=0,X=0,$=0,k=0,Z=0;return E.jsx("div",{onScroll:D,ref:f,style:{position:"relative",height:n,width:o,overflow:"auto",willChange:"transform"},children:E.jsx("div",{style:{height:V,width:b},children:h.map((T,M)=>(X=q,q+=T,F=_+M,$=C-H,E.jsx(p.Fragment,{children:z.map((x,G)=>(Z=$,$+=x,k=j+G,E.jsx(R,{data:c,rowIndex:F,columnIndex:k,isScrolling:l?B:void 0,style:{position:"absolute",top:X,height:T,left:Z,width:x}},d(F,k,c))))},d(F,0,c))))})})}),me=(t,e)=>t,pe=L.forwardRef(function(e,r){const{width:o,height:n,itemCount:u,itemOffsetMapping:s,children:S,itemData:a=void 0,itemKey:g=me,layout:c="vertical",useIsScrolling:d=!1}=e,l=s.itemOffset(u),i=L.useRef(null),{scrollOffset:v,renderOffset:f,renderSize:w,onScroll:I,doScrollTo:V}=U(l),y=ne(i),O=c==="vertical";L.useImperativeHandle(r,()=>({scrollTo(m){const h=i.current;h&&(O?h.scrollTo(0,V(m,h.clientHeight)):h.scrollTo(V(m,h.clientWidth),0))},scrollToItem(m){this.scrollTo(s.itemOffset(m))}}),[s]);function W(m){if(O){const{clientHeight:h,scrollHeight:j,scrollTop:C,scrollLeft:z}=m.currentTarget,R=I(h,j,C);R!=C&&i.current&&i.current.scrollTo(z,R)}else{const{clientWidth:h,scrollWidth:j,scrollTop:C,scrollLeft:z}=m.currentTarget,R=I(h,j,z);R!=z&&i.current&&i.current.scrollTo(R,C)}}const[H,b,K]=N(u,s,O?n:o,v+f),P=S;let B=b-f,D,_;return E.jsx("div",{onScroll:W,ref:i,style:{position:"relative",height:n,width:o,overflow:"auto",willChange:"transform"},children:E.jsx("div",{style:{height:O?w:"100%",width:O?"100%":w},children:K.map((m,h)=>(_=B,B+=m,D=H+h,E.jsx(P,{data:a,index:D,isScrolling:d?y:void 0,style:{position:"absolute",top:O?_:void 0,left:O?void 0:_,height:O?m:"100%",width:O?"100%":m}},g(D,a))))})})});class he{constructor(e){te(this,"fixedItemSize");this.fixedItemSize=e}itemSize(e){return this.fixedItemSize}itemOffset(e){return e*this.fixedItemSize}offsetToItem(e){const r=Math.floor(e/this.fixedItemSize),o=r*this.fixedItemSize;return[r,o]}}function ge(t){return new he(t)}export{pe as V,Oe as a,ge as u};
//# sourceMappingURL=useFixedSizeItemOffsetMapping-CHivuuFc.js.map
