var ce=Object.defineProperty;var fe=(t,e,n)=>e in t?ce(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ne=(t,e,n)=>(fe(t,typeof e!="symbol"?e+"":e,n),n);import{r as I,R as D,j as L}from"./vendor-Bnznptw5.js";function J(t,e,n,o){if(t==0)return[0,0,[]];var[r,s]=e.offsetToItem(o);r=Math.max(0,Math.min(t-1,r));var c=o+n;const x=1,l=1;for(let i=0;i<x&&r>0;i++)r--,s-=e.itemSize(r);const v=r;var S=s;const u=[];for(;S<c&&r<t;){const i=e.itemSize(r);u.push(i),S+=i,r++}for(let i=0;i<l&&r<t;i++){const R=e.itemSize(r);u.push(R),r++}return[v,s,u]}const ue=6e6,ae=100;function Q(t,e=ue,n=ae){let o=0,r=0,s=0;t<e?(o=r=t,s=1):(o=e,r=o/n,s=Math.floor(t/r));function c(i){return i<=0?0:i>=s-1?t-o:Math.round((i-1)*(t-o)/(s-3))}const x={scrollOffset:0,renderOffset:0,page:0,scrollDirection:"forward"},[l,v]=I.useState(x);function S(i,R,f){if(l.scrollOffset==f)return[f,l];let m=Math.max(0,Math.min(f,R-i));const h=l.scrollOffset<=m?"forward":"backward";let a,w,M=f;if(Math.abs(m-l.scrollOffset)<i)a=Math.min(s-1,Math.floor((f+l.renderOffset)/r)),w=c(a),a!=l.page&&(m=f+l.renderOffset-w,M=m);else{if(m<r)a=0;else if(m>=o-r)a=s-1;else{const _=(t-r*2)/(o-r*2);a=Math.min(s-3,Math.floor((m-r)*_/r))+1}w=c(a)}const d={scrollOffset:m,renderOffset:w,page:a,scrollDirection:h};return v(d),[M,d]}function u(i,R){const f=Math.min(t-R,Math.max(i,0)),m=l.scrollOffset+l.renderOffset<=f?"forward":"backward",h=Math.min(s-1,Math.floor(f/r)),a=c(h),w=f-a;return v({scrollOffset:w,renderOffset:a,page:h,scrollDirection:m}),w}return{...l,renderSize:o,onScroll:S,doScrollTo:u}}function B(t){return t.addEventListener!==void 0}function se(t,e,n=window,o={}){const r=I.useRef(),{capture:s,passive:c,once:x}=o;I.useEffect(()=>{r.current=e},[e]),I.useEffect(()=>{if(!n)return;const l=B(n)?n:n.current;if(!l)return;const v=u=>r.current(u),S={capture:s,passive:c,once:x};return l.addEventListener(t,v,S),()=>{l.removeEventListener(t,v,S)}},[t,n,s,c,x])}if(import.meta.vitest){const{it:t,expect:e}=import.meta.vitest;t("isListener",()=>{e(B(window)).toBe(!0),e(B(document)).toBe(!0),e(B(document.createElement("div"))).toBe(!0),e(B(I.createRef())).toBe(!1)})}function de(t,e,n){const o=I.useRef(),r=I.useRef(t);I.useEffect(()=>{r.current=t},[t]);const s=performance.now();I.useEffect(()=>{function c(){o.current=void 0,e!==null&&(performance.now()-s>=e?r.current():o.current=requestAnimationFrame(c))}return c(),()=>{typeof o.current=="number"&&(cancelAnimationFrame(o.current),o.current=void 0)}},[e,n])}const me=150,Se=500;function le(t=window){const[e,n]=I.useState(0),o="onscrollend"in window,r=o?Se:me;return se("scroll",()=>n(s=>s+1),t),se("scrollend",()=>n(0),o?t:null),de(()=>n(0),e==0?null:r,e),e>0}const he=(t,e,n)=>`${t}:${e}`,ve=D.forwardRef(function(e,n){const{width:o,height:r,rowCount:s,rowOffsetMapping:c,columnCount:x,columnOffsetMapping:l,children:v,itemData:S=void 0,itemKey:u=he,onScroll:i,useIsScrolling:R=!1}=e,f=c.itemOffset(s),m=l.itemOffset(x),h=D.useRef(null),{scrollOffset:a,renderOffset:w,renderSize:M,onScroll:F,doScrollTo:d}=Q(f,e.maxCssSize,e.minNumPages),{scrollOffset:_,renderOffset:P,renderSize:$,onScroll:G,doScrollTo:N}=Q(m,e.maxCssSize,e.minNumPages),W=le(h);D.useImperativeHandle(n,()=>({scrollTo(z,C){const p=h.current;p&&p.scrollTo(N(C,p.clientWidth),d(z,p.clientHeight))},scrollToItem(z,C){this.scrollTo(c.itemOffset(z),l.itemOffset(C))}}),[c,l,d,N]);function j(z){const{clientWidth:C,clientHeight:p,scrollWidth:b,scrollHeight:ie,scrollLeft:ee,scrollTop:te}=z.currentTarget,[re,X]=F(p,ie,te),[oe,Z]=G(C,b,ee);h.current&&(re!=te||oe!=ee)&&h.current.scrollTo(oe,re),i==null||i(X.scrollOffset+X.renderOffset,Z.scrollOffset+Z.renderOffset,X,Z)}const[A,O,g]=J(s,c,r,a+w),[H,V,y]=J(x,l,o,_+P),E=v;let T=O-w,K=0,Y=0,U=0,q=0,k=0;return L.jsx("div",{onScroll:j,ref:h,style:{position:"relative",height:r,width:o,overflow:"auto",willChange:"transform"},children:L.jsx("div",{style:{height:M,width:$},children:g.map((z,C)=>(Y=T,T+=z,K=A+C,U=V-P,L.jsx(I.Fragment,{children:y.map((p,b)=>(k=U,U+=p,q=H+b,L.jsx(E,{data:S,rowIndex:K,columnIndex:q,isScrolling:R?W:void 0,style:{position:"absolute",top:Y,height:z,left:k,width:p}},u(K,q,S))))},u(K,0,S))))})})}),we=(t,e)=>t,Ie=D.forwardRef(function(e,n){const{width:o,height:r,itemCount:s,itemOffsetMapping:c,children:x,itemData:l=void 0,itemKey:v=we,layout:S="vertical",onScroll:u,useIsScrolling:i=!1}=e,R=c.itemOffset(s),f=D.useRef(null),{scrollOffset:m,renderOffset:h,renderSize:a,onScroll:w,doScrollTo:M}=Q(R,e.maxCssSize,e.minNumPages),F=le(f),d=S==="vertical";D.useImperativeHandle(n,()=>({scrollTo(O){const g=f.current;g&&(d?g.scrollTo(0,M(O,g.clientHeight)):g.scrollTo(M(O,g.clientWidth),0))},scrollToItem(O){this.scrollTo(c.itemOffset(O))}}),[c,d,M]);function _(O){if(d){const{clientHeight:g,scrollHeight:H,scrollTop:V,scrollLeft:y}=O.currentTarget,[E,T]=w(g,H,V);E!=V&&f.current&&f.current.scrollTo(y,E),u==null||u(T.scrollOffset+T.renderOffset,T)}else{const{clientWidth:g,scrollWidth:H,scrollTop:V,scrollLeft:y}=O.currentTarget,[E,T]=w(g,H,y);E!=y&&f.current&&f.current.scrollTo(E,V),u==null||u(T.scrollOffset+T.renderOffset,T)}}const[P,$,G]=J(s,c,d?r:o,m+h),N=x;let W=$-h,j,A;return L.jsx("div",{onScroll:_,ref:f,style:{position:"relative",height:r,width:o,overflow:"auto",willChange:"transform"},children:L.jsx("div",{style:{height:d?a:"100%",width:d?"100%":a},children:G.map((O,g)=>(A=W,W+=O,j=P+g,L.jsx(N,{data:l,index:j,isScrolling:i?F:void 0,style:{position:"absolute",top:d?A:void 0,left:d?void 0:A,height:d?O:"100%",width:d?"100%":O}},v(j,l))))})})});class Oe{constructor(e){ne(this,"fixedItemSize");this.fixedItemSize=e}itemSize(e){return this.fixedItemSize}itemOffset(e){return e*this.fixedItemSize}offsetToItem(e){const n=Math.floor(e/this.fixedItemSize),o=n*this.fixedItemSize;return[n,o]}}function Te(t){return new Oe(t)}export{Ie as V,ve as a,Te as u};
//# sourceMappingURL=useFixedSizeItemOffsetMapping-DIBrUQ8f.js.map
