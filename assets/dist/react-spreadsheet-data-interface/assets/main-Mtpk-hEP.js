var ge=Object.defineProperty;var we=(t,e,r)=>e in t?ge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var ee=(t,e,r)=>we(t,typeof e!="symbol"?e+"":e,r);import{r as V,R as w,j as d,a as Ce}from"./vendor-DnZynArw.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();function pe(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)-64+e*26;return e-1}function te(t){let e="";for(t++;t>0;){t--;const r=t%26;t=Math.floor(t/26),e=String.fromCharCode(65+r)+e}return e}function xe(t){const e=/^([A-Z]*)(\d*)$/,r=t.match(e);if(!r)return[void 0,void 0];const s=r[1],n=parseInt(r[2]);return[n>0?n-1:void 0,s||void 0]}function Oe(t){const[e,r]=xe(t);return[e,r?pe(r):void 0]}function ve(t,e){return t!==void 0?e!==void 0?te(e)+(t+1):(t+1).toString():e!==void 0?te(e):""}function ne(t,e,r,s){if(t==0)return[0,0,[]];let[n,o]=e.offsetToItem(s);n=Math.max(0,Math.min(t-1,n));const c=s+r,T=1,u=1;for(let l=0;l<T&&n>0;l++)n--,o-=e.itemSize(n);const _=n;let I=o;const S=[];for(;I<c&&n<t;){const l=e.itemSize(n);S.push(l),I+=l,n++}for(let l=0;l<u&&n<t;l++){const p=e.itemSize(n);S.push(p),n++}return[_,o,S]}const Re=6e6,Te=100;function re(t,e=Re,r=Te){let s=0,n=0,o=0;t<e?(s=n=t,o=1):(s=e,n=s/r,o=Math.floor(t/n));function c(l){return l<=0?0:l>=o-1?t-s:Math.round((l-1)*(t-s)/(o-3))}const T={scrollOffset:0,renderOffset:0,page:0,scrollDirection:"forward"},[u,_]=V.useState(T);function I(l,p,m){if(u.scrollOffset==m)return[m,u];let x=Math.max(0,Math.min(m,p-l));const O=u.scrollOffset<=x?"forward":"backward";let g,f,N=m;if(Math.abs(x-u.scrollOffset)<l)g=Math.min(o-1,Math.floor((m+u.renderOffset)/n)),f=c(g),g!=u.page&&(x=m+u.renderOffset-f,N=x);else{if(x<n)g=0;else if(x>=s-n)g=o-1;else{const D=(t-n*2)/(s-n*2);g=Math.min(o-3,Math.floor((x-n)*D/n))+1}f=c(g)}const y={scrollOffset:x,renderOffset:f,page:g,scrollDirection:O};return _(y),[N,y]}function S(l,p){const m=Math.min(t-p,Math.max(l,0)),x=u.scrollOffset+u.renderOffset<=m?"forward":"backward",O=Math.min(o-1,Math.floor(m/n)),g=c(O),f=m-g;return _({scrollOffset:f,renderOffset:g,page:O,scrollDirection:x}),f}return{...u,renderSize:s,onScroll:I,doScrollTo:S}}function Z(t){return t.addEventListener!==void 0}function ae(t,e,r=window,s={}){const n=V.useRef(),{capture:o,passive:c,once:T}=s;V.useEffect(()=>{n.current=e},[e]),V.useEffect(()=>{if(!r)return;const u=Z(r)?r:r.current;if(!u)return;const _=S=>{var l;return(l=n.current)==null?void 0:l.call(n,S)},I={capture:o,passive:c,once:T};return u.addEventListener(t,_,I),()=>{u.removeEventListener(t,_,I)}},[t,r,o,c,T])}if(import.meta.vitest){const{it:t,expect:e}=import.meta.vitest;t("isListener",()=>{e(Z(window)).toBe(!0),e(Z(document)).toBe(!0),e(Z(document.createElement("div"))).toBe(!0),e(Z(V.createRef())).toBe(!1)})}function Ie(t,e,r){const s=V.useRef(),n=V.useRef(t);V.useEffect(()=>{n.current=t},[t]);const o=performance.now();V.useEffect(()=>{function c(){s.current=void 0,e!==null&&(performance.now()-o>=e?n.current():s.current=requestAnimationFrame(c))}return c(),()=>{typeof s.current=="number"&&(cancelAnimationFrame(s.current),s.current=void 0)}},[o,e,r])}const _e=150,ye=500;function he(t=window){const[e,r]=V.useState(0),s="onscrollend"in window,n=s?ye:_e;return ae("scroll",()=>r(o=>o+1),t),ae("scrollend",()=>r(0),s?t:null),Ie(()=>r(0),e==0?null:n,e),e>0}const Ne=(t,e,r)=>`${t}:${e}`,Me=w.forwardRef(function(e,r){const{width:s,height:n,rowCount:o,rowOffsetMapping:c,columnCount:T,columnOffsetMapping:u,children:_,className:I,innerClassName:S,itemData:l=void 0,itemKey:p=Ne,onScroll:m,useIsScrolling:x=!1}=e,O=c.itemOffset(o),g=u.itemOffset(T),f=w.useRef(null),{scrollOffset:N,renderOffset:M,renderSize:y,onScroll:D,doScrollTo:v}=re(O,e.maxCssSize,e.minNumPages),{scrollOffset:E,renderOffset:W,renderSize:K,onScroll:j,doScrollTo:G}=re(g,e.maxCssSize,e.minNumPages),U=he(f);w.useImperativeHandle(r,()=>({scrollTo(P,A){const z=f.current;if(z){const b={};P!=null&&(b.top=v(P,z.clientHeight)),A!=null&&(b.left=G(A,z.clientWidth)),z.scrollTo(b)}},scrollToItem(P,A){const z=P!=null?c.itemOffset(P):void 0,b=A!=null?u.itemOffset(A):void 0;this.scrollTo(z,b)},get clientWidth(){return f.current?f.current.clientWidth:0},get clientHeight(){return f.current?f.current.clientHeight:0}}),[c,u,v,G]);function q(P){const{clientWidth:A,clientHeight:z,scrollWidth:b,scrollHeight:Se,scrollLeft:le,scrollTop:ce}=P.currentTarget,[ue,Y]=D(z,Se,ce),[fe,k]=j(A,b,le);f.current&&(ue!=ce||fe!=le)&&f.current.scrollTo(fe,ue),m==null||m(Y.scrollOffset+Y.renderOffset,k.scrollOffset+k.renderOffset,Y,k)}const[$,B,F]=ne(o,c,n,N+M),[R,i,a]=ne(T,u,s,E+W),h=_,C=e.outerComponent||"div",L=e.innerComponent||"div";let H=B-M,X=0,se=0,J=0,Q=0,ie=0;return d.jsx(C,{className:I,onScroll:q,ref:f,style:{position:"relative",height:n,width:s,overflow:"auto",willChange:"transform"},children:d.jsx(L,{className:S,style:{height:y,width:K},children:F.map((P,A)=>(se=H,H+=P,X=$+A,J=i-W,d.jsx(V.Fragment,{children:a.map((z,b)=>(ie=J,J+=z,Q=R+b,d.jsx(h,{data:l,rowIndex:X,columnIndex:Q,isScrolling:x?U:void 0,style:{position:"absolute",top:se,height:P,left:ie,width:z}},p(X,Q,l))))},p(X,0,l))))})})}),ze=(t,e)=>t,de=w.forwardRef(function(e,r){const{width:s,height:n,itemCount:o,itemOffsetMapping:c,children:T,className:u,innerClassName:_,itemData:I=void 0,itemKey:S=ze,layout:l="vertical",onScroll:p,useIsScrolling:m=!1}=e,x=c.itemOffset(o),O=w.useRef(null),{scrollOffset:g,renderOffset:f,renderSize:N,onScroll:M,doScrollTo:y}=re(x,e.maxCssSize,e.minNumPages),D=he(O),v=l==="vertical";w.useImperativeHandle(r,()=>({scrollTo(R){const i=O.current;i&&(v?i.scrollTo(0,y(R,i.clientHeight)):i.scrollTo(y(R,i.clientWidth),0))},scrollToItem(R){this.scrollTo(c.itemOffset(R))}}),[c,v,y]);function E(R){if(v){const{clientHeight:i,scrollHeight:a,scrollTop:h,scrollLeft:C}=R.currentTarget,[L,H]=M(i,a,h);L!=h&&O.current&&O.current.scrollTo(C,L),p==null||p(H.scrollOffset+H.renderOffset,H)}else{const{clientWidth:i,scrollWidth:a,scrollTop:h,scrollLeft:C}=R.currentTarget,[L,H]=M(i,a,C);L!=C&&O.current&&O.current.scrollTo(L,h),p==null||p(H.scrollOffset+H.renderOffset,H)}}const[W,K,j]=ne(o,c,v?n:s,g+f),G=T,U=e.outerComponent||"div",q=e.innerComponent||"div";let $=K-f,B,F;return d.jsx(U,{className:u,onScroll:E,ref:O,style:{position:"relative",height:n,width:s,overflow:"auto",willChange:"transform"},children:d.jsx(q,{className:_,style:{height:v?N:"100%",width:v?"100%":N},children:j.map((R,i)=>(F=$,$+=R,B=W+i,d.jsx(G,{data:I,index:B,isScrolling:m?D:void 0,style:{position:"absolute",top:v?F:void 0,left:v?void 0:F,height:v?R:"100%",width:v?"100%":R}},S(B,I))))})})});class Ve{constructor(e){ee(this,"fixedItemSize");this.fixedItemSize=e}itemSize(e){return this.fixedItemSize}itemOffset(e){return e*this.fixedItemSize}offsetToItem(e){const r=Math.floor(e/this.fixedItemSize),s=r*this.fixedItemSize;return[r,s]}}function me(t){return new Ve(t)}const oe=w.forwardRef(({style:t,...e},r)=>d.jsx("div",{ref:r,style:{...t,overflow:"hidden"},...e}));oe.displayName="HideScrollBar";function Ee(t,e){return t&&e?t+" "+e:t||e}function je(t){var R;const{theme:e,data:r,minRowCount:s=100,minColumnCount:n=26,maxRowCount:o=1e12,maxColumnCount:c=1e12}=t,T=me(100),u=me(30),_=w.useRef(null),I=w.useRef(null),S=w.useRef(null),l=w.useRef(!1),p=w.useCallback(i=>r.subscribe(i),[r]),m=w.useSyncExternalStore(p,r.getSnapshot.bind(r),(R=r.getServerSnapshot)==null?void 0:R.bind(r)),[x,O]=w.useState(""),[g,f]=w.useState(0),[N,M]=w.useState(0),[y,D]=w.useState([void 0,void 0]),v=r.getRowCount(m),E=Math.max(s,v,g+1),W=u.itemOffset(E),K=r.getColumnCount(m),j=Math.max(n,K,N+1),G=T.itemOffset(j);w.useLayoutEffect(()=>{var i;l.current&&(l.current=!1,(i=S.current)==null||i.scrollToItem(y[0],y[1]))},[y]);function U(i,a){var h,C;(h=_.current)==null||h.scrollTo(a),(C=I.current)==null||C.scrollTo(i),i==0?f(0):S.current&&i+S.current.clientHeight==W&&g<E&&E<o&&f(E),a==0?M(0):S.current&&a+S.current.clientWidth==G&&N<j&&j<c&&M(j)}function q(i){var L;if(i.key!=="Enter")return;let a=!1,[h,C]=Oe(x);h!==void 0&&(h>=o&&(h=o-1),h>g?(f(h),a=!0):h==0&&f(0)),C!==void 0&&(C>=c&&(C=c-1),C>N?(M(C),a=!0):C==0&&M(0)),D([h,C]),a?l.current=!0:(L=S.current)==null||L.scrollToItem(h,C)}const $=({index:i,style:a})=>d.jsx("div",{className:e==null?void 0:e.VirtualSpreadsheet_Column,style:a,children:te(i)}),B=({index:i,style:a})=>d.jsx("div",{className:e==null?void 0:e.VirtualSpreadsheet_Row,style:a,children:i+1}),F=({rowIndex:i,columnIndex:a,style:h})=>d.jsx("div",{className:e==null?void 0:e.VirtualSpreadsheet_Cell,style:h,children:i<v&&a<K?r.getCellValue(m,i,a):""});return d.jsxs("div",{className:Ee(t.className,e==null?void 0:e.VirtualSpreadsheet),style:{display:"grid",gridTemplateColumns:"100px 1fr",gridTemplateRows:"50px 50px 1fr"},children:[d.jsx("div",{className:e==null?void 0:e.VirtualSpreadsheet_Name,style:{gridColumnStart:1,gridColumnEnd:3},children:d.jsxs("label",{children:["Scroll To Row, Column or Cell:",d.jsx("input",{type:"text",value:x,height:200,onChange:i=>{var a;O((a=i.target)==null?void 0:a.value)},onKeyUp:q})]})}),d.jsx("div",{}),d.jsx(de,{ref:_,className:e==null?void 0:e.VirtualSpreadsheet_ColumnHeader,outerComponent:oe,height:50,itemCount:j,itemOffsetMapping:T,layout:"horizontal",maxCssSize:t.maxCssSize,minNumPages:t.minNumPages,width:t.width,children:$}),d.jsx(de,{ref:I,className:e==null?void 0:e.VirtualSpreadsheet_RowHeader,outerComponent:oe,height:t.height,itemCount:E,itemOffsetMapping:u,maxCssSize:t.maxCssSize,minNumPages:t.minNumPages,width:100,children:B}),d.jsx(Me,{className:e==null?void 0:e.VirtualSpreadsheet_Grid,ref:S,onScroll:U,height:t.height,rowCount:E,rowOffsetMapping:u,columnCount:j,columnOffsetMapping:T,maxCssSize:t.maxCssSize,minNumPages:t.minNumPages,width:t.width,children:F})]})}const Le="_VirtualSpreadsheet_ColumnHeader_1sf9h_1",He="_VirtualSpreadsheet_RowHeader_1sf9h_1",Pe="_VirtualSpreadsheet_Grid_1sf9h_1",Ae={VirtualSpreadsheet_ColumnHeader:Le,VirtualSpreadsheet_RowHeader:He,VirtualSpreadsheet_Grid:Pe};class be{constructor(){ee(this,"count");this.count=0}subscribe(e){const r=setInterval(()=>{this.count++,e()},1e3);return()=>{clearInterval(r)}}getSnapshot(){return this.count}getRowCount(e){return e}getColumnCount(e){return 26}getCellValue(e,r,s){return ve(r,s)}}const De=new be;function Be(){return d.jsx(je,{data:De,theme:Ae,height:240,maxRowCount:1e6,maxColumnCount:100,width:600})}Ce.render(d.jsx(w.StrictMode,{children:d.jsx(Be,{})}),document.getElementById("root"));
//# sourceMappingURL=main-Mtpk-hEP.js.map
